---
title: "DM"
author: "Vivien & Louis"
date: "01/03/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Question 1


Le meilleur estimateur de ${f}(x)$ au sens de l'erreur quadratique moyenne intégrée est l'estimateur de Parzen-Rosenblatt $\hat{f}(x) = \frac{1}{nh_{cv}}\sum_{j=1}^{n}K(\frac{x-X_{j}}{h_{cv}})$ ou K est un noyau choisi et $h_{cv}$ petit obtenue par validation croisé *leave-one-out*.


```{r, echo=FALSE, message=FALSE}
library(readr)
devA <- read_csv("C:\\Users\\admin\\Documents\\Statistique_non_parametrique\\donnees_source\\devA.txt", col_names = FALSE)
```



```{r, echo = FALSE, warning=FALSE}
plot(density(devA$X1, bw="ucv", adjust=1, kernel="gaussian"), main = "Estimation de f(x) par noyau gaussien")
plot(density(devA$X1, bw="ucv", adjust=1, kernel="rectangular"), main = "Estimation de f(x) par noyau rectangulaire")
plot(density(devA$X1, bw="ucv", adjust=1, kernel="triangular"), main = "Estimation de f(x) par noyau triangulaire")
plot(density(devA$X1, bw="ucv", adjust=1, kernel="epanechnikov"), main = "Estimation de f(x) par noyau epanechnikov")
plot(density(devA$X1, bw="ucv", adjust=1, kernel="cosine"), main = "Estimation de f(x) par noyau cosine")
plot(density(devA$X1, bw="ucv", adjust=1, kernel="biweight"), main = "Estimation de f(x) par noyau biweight")
```



# Question 2


- Puisque l'on estime une loi de densité (semblant continue de par les nombreux chiffres après la virgule des observations) on souhaite que notre estimation ait les bonnes propriétés associées aux lois de densité. Ainsi il vient naturellement que le noyau $K$ doit être une densité de probabilité, lisse, continue et différentiable. Par défaut et sans information supplémentaire j'ai décidé de retenir le noyau gaussien. De plus, en faisant exception des valeurs extrêmes de notre echantillon, la partie centrale de la distribution de notre echantillon semble suivre une loi normale.

```{r, echo=FALSE}
qqnorm(devA$X1, main = "Echantillon devA", xlab = "Quantiles théoriques de loi normale", ylab = "Quantiles observés")
qqline(devA$X1)
```

- Pour ce qui est de choix de $h$  



#Partie B

##Question 1

Sachant que les données observées sont issues d'une régression linéaire,que nos valeurs manquantes sont en fait des réponses et que l'hypothèse des observations MAR est satisfaite on a :

$Y=m(X)+eps, E(eps|X)=0 => rho(Y,X)=Y-m(X)$ et $Y||D,X$ si $D=0,1$

On souhaite estimer l'esperance de Y donc on a le systeme suivant;

\left \{
\begin{array}{rcl}
E[Y-alpha0]=0\\
D||Y,X
\end{array}
\right
=> 
\left \{
\begin{array}{rcl}
E[(D/p(X)*(Y-alpha0)]=0\\
E[(D/p(X))-1|X]=0
\end{array}
\right


```{r}
library(zoo)
dataB<-read.table("C:\\Users\\admin\\Documents\\Statistique_non_parametrique\\donnees_source\\devB.txt")


dataB$V1<-na.aggregate(dataB$V1,fUN=median)

plot(ksmooth(dataB$V2,dataB$V1, kernel = "normal", bandwidth =0.2,
             range.x = range(dataB$V2)),ylim=c(min(dataB$V1),max(dataB$V1)),col="red")
lines(ksmooth(dataB$V2,dataB$V1, kernel = "normal", bandwidth = 1,
              range.x = range(dataB$V2)),col="blue")
lines(ksmooth(dataB$V2,dataB$V1, kernel = "normal", bandwidth = 0.5,
              range.x = range(dataB$V2)),col="green")
lines(ksmooth(dataB$V2,dataB$V1, kernel = "normal", bandwidth = 2,
              range.x = range(dataB$V2)),col="skyblue")
lines(ksmooth(dataB$V2,dataB$V1, kernel = "normal", bandwidth = 5,
              range.x = range(dataB$V2)),col="pink")
abline(h=0.5,col="black")

```

